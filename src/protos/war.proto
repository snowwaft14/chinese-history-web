syntax = "proto3";

option csharp_namespace = "Newinfosoft.ChineseHistory.Server.ServiceBase";

package chinesehistory;

import "common.proto";

// 战争实体 - 历史上的军事冲突
message War {
  string id = 1;                        // 战争唯一标识符
  string name = 2;                      // 战争名称（如"城濮之战"）
  string description = 3;               // 战争描述
  GregorianDate start_date = 4;         // 开始日期
  GregorianDate end_date = 5;           // 结束日期
  string geometry_json = 6;             // 地理位置JSON（GeoJSON格式）
  WarType war_type = 7;                 // 战争类型
  repeated string tags = 8;             // 标签
  repeated string search_values = 9;    // 搜索辅助工具，例如拼音、声母
}

// 战争类型枚举
enum WarType {
  UNKNOWN_WAR = 0;                      // 未知
  CIVIL_WAR = 1;                        // 内战
  FOREIGN_WAR = 2;                      // 对外战争
  REBELLION = 3;                        // 叛乱
  PEASANT_UPRISING = 4;                 // 农民起义
  SUCCESSION_WAR = 5;                   // 王位继承战争
  TERRITORIAL_WAR = 6;                  // 领土争夺战
  DEFENSIVE_WAR = 7;                    // 防御战争
  CONQUEST_WAR = 8;                     // 征服战争
}

// 获取多个战争响应（统一用于GetWars和FindWars）
message GetWarsResponse {
  repeated War wars = 1;
}

// 获取战争请求（无查询条件）
message GetWarsRequest {
  // 空请求，获取所有战争
}

// 查找战争请求（包含所有可能的查询条件）
message FindWarsRequest {
  string war_id = 1;                     // 战争ID（可选）
  string name = 2;                       // 战争名称（支持模糊搜索）（可选）
  WarType war_type = 3;                  // 战争类型（可选）
  GregorianDate start_date = 4;          // 开始日期（可选）
  GregorianDate end_date = 5;            // 结束日期（可选）
  repeated WarType war_types = 6;        // 战争类型过滤（可选）
  repeated string tags = 7;              // 标签过滤（可选）
}

// =========================== 批量CRUD操作 ===========================

// 批量战争操作请求
message UpsertWarsRequest {
  repeated War wars = 1;                 // 要插入或更新的战争列表
}

// 批量删除战争请求
message DeleteWarsRequest {
  repeated string war_ids = 1;           // 要删除的战争ID列表
}

service WarService {
  // ============== 查询操作 ==============
  // 获取所有战争
  rpc GetWars(GetWarsRequest) returns (GetWarsResponse);
  
  // 查找战争（根据条件）
  rpc FindWars(FindWarsRequest) returns (GetWarsResponse);
  
  // ============== 批量CRUD操作 ==============
  // 批量插入或更新战争
  rpc UpsertWars(UpsertWarsRequest) returns (BatchOperationResponse);
  
  // 批量删除战争
  rpc DeleteWars(DeleteWarsRequest) returns (BatchOperationResponse);
}